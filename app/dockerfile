FROM node@sha256:b20f82c2332a22609edb43cdfd6b16cbb199a6e6fd5cf8d5ef85b43faab43144 AS builder

WORKDIR /app

COPY package.json yarn.lock .

RUN yarn install

COPY . . 

RUN yarn build

FROM node@sha256:f4769ca6eeb6ebbd15eb9c8233afed856e437b75f486f7fccaa81d7c8ad56007 AS production

RUN adduser -u 1001 -D rihad

WORKDIR /app

COPY --from=builder /app/build ./build

RUN yarn global add serve

USER rihad

EXPOSE 3000

CMD ["serve", "-s", "build"]

